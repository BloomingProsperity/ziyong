# AI Agent å†³ç­–æŒ‡å— - Skillsä¸²è”ä½¿ç”¨æ‰‹å†Œ

> **ç›®æ ‡è¯»è€…**: AI Agent (Claudeç­‰å¤§è¯­è¨€æ¨¡å‹)
> **ç”¨é€”**: ç†è§£å¦‚ä½•ä¸²è”ä½¿ç”¨27ä¸ªSkillsæ¨¡å—ï¼Œå®ç°æ™ºèƒ½çˆ¬è™«ä»»åŠ¡

---

## ğŸ“‹ å¿«é€Ÿå¯¼èˆª

- [æ ¸å¿ƒå†³ç­–é€»è¾‘](#æ ¸å¿ƒå†³ç­–é€»è¾‘)
- [ä»»åŠ¡ç±»å‹è¯†åˆ«](#ä»»åŠ¡ç±»å‹è¯†åˆ«)
- [Skillsä¸²è”æ¨¡å¼](#skillsä¸²è”æ¨¡å¼)
- [å†³ç­–æ ‘](#å†³ç­–æ ‘)
- [å®æˆ˜æ¡ˆä¾‹](#å®æˆ˜æ¡ˆä¾‹)

---

## ğŸ¯ æ ¸å¿ƒå†³ç­–é€»è¾‘

### ä½ çš„è§’è‰²å®šä½

ä½œä¸ºAI Agentï¼Œä½ æ˜¯**18-brain-controller**ï¼ˆå†³ç­–æ€»æ§ï¼‰ï¼š
- **è¾“å…¥**: ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€ä»»åŠ¡æè¿°
- **èŒè´£**: ç†è§£ä»»åŠ¡ â†’ é€‰æ‹©Skills â†’ ç¼–æ’æ‰§è¡Œ â†’ å¤„ç†ç»“æœ
- **è¾“å‡º**: ç»“æ„åŒ–æ•°æ®æˆ–åˆ†ææŠ¥å‘Š

### ä¸‰æ­¥å†³ç­–æ¡†æ¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     AI Agent å†³ç­–æ¡†æ¶                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Step 1: ä»»åŠ¡ç†è§£ (UNDERSTAND)                                   â”‚
â”‚  â”œâ”€ æå–å…³é”®ä¿¡æ¯: URLã€ç›®æ ‡æ•°æ®ã€æ•°é‡ã€æ—¶é—´è¦æ±‚                   â”‚
â”‚  â”œâ”€ è¯†åˆ«ä»»åŠ¡ç±»å‹: EXPLICIT/FUZZY/TROUBLESHOOT/QUERY              â”‚
â”‚  â””â”€ åˆ¤æ–­ä¿¡æ¯å®Œæ•´æ€§: ç¼ºå¤±åˆ™è¯¢é—®ç”¨æˆ·                               â”‚
â”‚                                                                 â”‚
â”‚  Step 2: æ¨¡å—é€‰æ‹© (SELECT)                                       â”‚
â”‚  â”œâ”€ åŒ¹é…è§¦å‘æ¡ä»¶: æ ¹æ®task_typeå’Œsite_features                   â”‚
â”‚  â”œâ”€ æ£€æŸ¥ä¾èµ–å…³ç³»: ç¡®ä¿requiredä¾èµ–æ»¡è¶³                           â”‚
â”‚  â””â”€ ç”Ÿæˆæ‰§è¡Œè®¡åˆ’: [skill_1, skill_2, ...]                       â”‚
â”‚                                                                 â”‚
â”‚  Step 3: æµç¨‹æ‰§è¡Œ (EXECUTE)                                      â”‚
â”‚  â”œâ”€ é¡ºåºè°ƒç”¨Skills                                              â”‚
â”‚  â”œâ”€ ç›‘æ§æ‰§è¡ŒçŠ¶æ€                                                â”‚
â”‚  â”œâ”€ é”™è¯¯è‡ªåŠ¨æ¢å¤: è°ƒç”¨19-fault-decision-tree                     â”‚
â”‚  â””â”€ è¿”å›ç»“æœæˆ–æŠ¥å‘Š                                              â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” ä»»åŠ¡ç±»å‹è¯†åˆ«

### TYPE_EXPLICIT (æ˜ç¡®ä»»åŠ¡) - 80%çš„åœºæ™¯

**è§¦å‘ç‰¹å¾:**
- âœ… æœ‰æ˜ç¡®çš„URL
- âœ… æœ‰æ˜ç¡®çš„ç›®æ ‡æ•°æ®
- âœ… ä¿¡æ¯å®Œæ•´ï¼Œå¯ç›´æ¥æ‰§è¡Œ

**ç”¨æˆ·è¾“å…¥ç¤ºä¾‹:**
```
"çˆ¬å–è±†ç“£ç”µå½±Top250çš„æ ‡é¢˜ã€è¯„åˆ†ã€å¯¼æ¼”"
"è·å–https://example.com/api/productsçš„å‰100æ¡æ•°æ®"
"æŠ“å–äº¬ä¸œæ‰‹æœºåˆ†ç±»ä¸‹çš„å•†å“ä¿¡æ¯"
```

**å¤„ç†æµç¨‹:**
```
EXPLICIT â†’ 01-reconnaissance (ä¾¦æŸ¥)
         â†’ åˆ¤æ–­anti_level
         â†’ é€‰æ‹©æ‰§è¡Œè·¯å¾„ (è§ä¸‹æ–¹å†³ç­–æ ‘)
         â†’ è¿”å›æ•°æ®
```

---

### TYPE_FUZZY (æ¨¡ç³Šä»»åŠ¡) - 15%çš„åœºæ™¯

**è§¦å‘ç‰¹å¾:**
- âœ… æœ‰URLï¼Œä½†ç›®æ ‡æ•°æ®ä¸æ˜ç¡®
- âš ï¸ éœ€è¦æ¢ç´¢å’Œåˆ†æ

**ç”¨æˆ·è¾“å…¥ç¤ºä¾‹:**
```
"åˆ†æä¸€ä¸‹https://example.comè¿™ä¸ªç½‘ç«™"
"çœ‹çœ‹è¿™ä¸ªç½‘ç«™æœ‰ä»€ä¹ˆæ•°æ®å¯ä»¥çˆ¬"
"ç›‘æ§è¿™ä¸ªç½‘ç«™çš„ä»·æ ¼å˜åŒ–"
```

**å¤„ç†æµç¨‹:**
```
FUZZY â†’ 01-reconnaissance (æ·±åº¦ä¾¦æŸ¥)
      â†’ 16-tactics (æˆ˜æœ¯å†³ç­–ï¼Œå…¥å£å‘ç°)
      â†’ è¯¢é—®ç”¨æˆ·ç¡®è®¤ç›®æ ‡
      â†’ è½¬ä¸ºEXPLICITç»§ç»­æ‰§è¡Œ
```

---

### TYPE_TROUBLESHOOT (æ•…éšœè¯Šæ–­) - 4%çš„åœºæ™¯

**è§¦å‘ç‰¹å¾:**
- ğŸ”´ åŒ…å«é”™è¯¯ç  (403/éªŒè¯ç /ç­¾åå¤±è´¥)
- ğŸ”´ æ‰§è¡Œå¤±è´¥éœ€è¦è¯Šæ–­

**ç”¨æˆ·è¾“å…¥ç¤ºä¾‹:**
```
"è¯·æ±‚è¿”å›403æ€ä¹ˆåŠ"
"é‡åˆ°éªŒè¯ç äº†"
"ç­¾åå‚æ•°ä¸€ç›´é”™è¯¯"
```

**å¤„ç†æµç¨‹:**
```
TROUBLESHOOT â†’ 19-fault-decision-tree (æ•…éšœå†³ç­–æ ‘)
             â†’ è‡ªåŠ¨è¯Šæ–­ (ç½‘ç»œ/HTTP/åçˆ¬/æ•°æ®å±‚)
             â†’ åº”ç”¨æ¢å¤ç­–ç•¥
             â†’ é‡è¯•æˆ–æŠ¥å‘Š
```

---

### TYPE_QUERY (ä¿¡æ¯æŸ¥è¯¢) - 1%çš„åœºæ™¯

**è§¦å‘ç‰¹å¾:**
- â“ æ— actionåŠ¨è¯
- â“ è¯¢é—®çŸ¥è¯†æˆ–æ–¹æ³•

**ç”¨æˆ·è¾“å…¥ç¤ºä¾‹:**
```
"äº¬ä¸œçš„åçˆ¬æœºåˆ¶æ˜¯ä»€ä¹ˆ"
"h5stç­¾åæ€ä¹ˆç ´è§£"
"ä»€ä¹ˆæ—¶å€™éœ€è¦ä»£ç†"
```

**å¤„ç†æµç¨‹:**
```
QUERY â†’ 22-knowledge-format (æŸ¥è¯¢çŸ¥è¯†åº“)
      â†’ è¿”å›çŸ¥è¯†æ¡ç›®
      â†’ (å¯é€‰) 20-e2e-cases (æä¾›æ¡ˆä¾‹)
```

---

## ğŸ”— Skillsä¸²è”æ¨¡å¼

### æ¨¡å¼1: ç®€å•æµç¨‹ (LOWåçˆ¬)

**é€‚ç”¨åœºæ™¯**: é™æ€é¡µé¢ã€å…¬å¼€APIã€æ— åŠ å¯†

```
01-reconnaissance (ä¾¦æŸ¥)
    â†“
åˆ¤æ–­: anti_level = LOW
    â†“
04-request (ç›´æ¥è¯·æ±‚)
    â†“
05-parsing (æ•°æ®è§£æ)
    â†“
06-storage (å­˜å‚¨å¯¼å‡º)
```

**ä»£ç ç¤ºä¾‹:**
```python
# Step 1: ä¾¦æŸ¥
analysis = brain.smart_investigate(url)

# Step 2: åˆ¤æ–­
if analysis.anti_scrape_level == "low":
    # Step 3: ç›´æ¥è¯·æ±‚
    result = brain.call_api(analysis.main_data_api["url"])

    # Step 4: è§£æ (å¦‚æœè¿”å›HTML)
    if "html" in result.headers.get("content-type"):
        data = brain.scrape_page(url)
    else:
        data = result.body

    # Step 5: å­˜å‚¨
    brain.export_data(data, "output")
```

---

### æ¨¡å¼2: ä¸­ç­‰æµç¨‹ (MEDIUMåçˆ¬)

**é€‚ç”¨åœºæ™¯**: CookieéªŒè¯ã€ç®€å•ç­¾åã€é™æµ

```
01-reconnaissance (ä¾¦æŸ¥)
    â†“
åˆ¤æ–­: anti_level = MEDIUM
    â†“
02-anti-detection (ä¼ªè£…)
    â†“
24-credential-pool (å¯é€‰ï¼Œå¦‚éœ€ç™»å½•)
    â†“
04-request (è¯·æ±‚)
    â†“
05-parsing (è§£æ)
    â†“
06-storage (å­˜å‚¨)
```

**ä»£ç ç¤ºä¾‹:**
```python
# Step 1: ä¾¦æŸ¥
analysis = brain.smart_investigate(url)

# Step 2: åˆ¤æ–­
if analysis.anti_scrape_level == "medium":
    # Step 3: é…ç½®åæ£€æµ‹
    config = AgentConfig(
        stealth_mode=True,
        use_random_ua=True
    )

    # Step 4: å¦‚éœ€ç™»å½•
    if analysis.login_required:
        brain.use_pool_cookie(url)

    # Step 5: è¯·æ±‚
    result = brain.call_api(url, use_collected_cookies=True)

    # Step 6-7: è§£æå’Œå­˜å‚¨
    brain.export_data(result.body, "output")
```

---

### æ¨¡å¼3: å¤æ‚æµç¨‹ (HIGHåçˆ¬)

**é€‚ç”¨åœºæ™¯**: å¤æ‚ç­¾åã€éªŒè¯ç ã€å¼ºåçˆ¬

```
01-reconnaissance (ä¾¦æŸ¥)
    â†“
åˆ¤æ–­: anti_level = HIGH
    â†“
16-tactics (æˆ˜æœ¯å†³ç­–ï¼Œé€‰æ‹©æœ€ä¼˜å…¥å£)
    â†“
â”œâ”€ è·¯å¾„A: æœ‰ç­¾å â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  03-signature (ç­¾ååˆ†æ)            â”‚
â”‚      â†“                             â”‚
â”‚  09-js-reverse (JSé€†å‘ï¼Œå¦‚å¤æ‚)     â”‚
â”‚      â†“                             â”‚
â”‚  RPCç­¾åæœåŠ¡ æˆ– è¡¥ç¯å¢ƒ               â”‚
â”‚                                    â”‚
â”œâ”€ è·¯å¾„B: æœ‰éªŒè¯ç  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  10-captcha (éªŒè¯ç è¯†åˆ«)            â”‚
â”‚                                    â”‚
â”œâ”€ è·¯å¾„C: éœ€æŒ‡çº¹ä¼ªè£… â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  11-fingerprint (æŒ‡çº¹ç”Ÿæˆ)         â”‚
â”‚                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â†“
        02-anti-detection (åæ£€æµ‹)
                 â†“
        04-request (è¯·æ±‚)
                 â†“
        05-parsing (è§£æ)
                 â†“
        06-storage (å­˜å‚¨)
```

**ä»£ç ç¤ºä¾‹:**
```python
# Step 1: ä¾¦æŸ¥
analysis = brain.smart_investigate(url)

# Step 2: åˆ¤æ–­
if analysis.anti_scrape_level == "high":
    # Step 3: æˆ˜æœ¯å†³ç­–
    # (16-tactics è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜è·¯å¾„)

    # Step 4: ç­¾åå¤„ç†
    if analysis.signature_params:
        # ä½¿ç”¨RPCæˆ–è¡¥ç¯å¢ƒæ–¹æ¡ˆ
        # (å‚è€ƒ03-signature.mdç¤ºä¾‹)
        pass

    # Step 5: éªŒè¯ç å¤„ç†
    if "captcha" in analysis.anti_scrape_features:
        # (å‚è€ƒ10-captcha.md)
        pass

    # Step 6: æŒ‡çº¹ä¼ªè£…
    config = AgentConfig(
        use_fingerprint=True,
        stealth_mode=True
    )

    # Step 7-10: è¯·æ±‚ã€è§£æã€å­˜å‚¨
    # ...
```

---

### æ¨¡å¼4: æé™æµç¨‹ (EXTREMEåçˆ¬)

**é€‚ç”¨åœºæ™¯**: äº¬ä¸œh5stã€æ·˜å®mtopã€Cloudflare

```
01-reconnaissance (ä¾¦æŸ¥)
    â†“
åˆ¤æ–­: anti_level = EXTREME
    â†“
å†³ç­–: æ˜¯å¦æœ‰é¢„è®¾é…ç½®?
    â”œâ”€ YES â†’ ä½¿ç”¨é¢„è®¾ (presets.py)
    â””â”€ NO  â†’ ç»§ç»­åˆ†æ
        â†“
16-tactics (æˆ˜æœ¯å†³ç­–)
    â†“
09-js-reverse (æ·±åº¦é€†å‘)
    â†“
03-signature (RPCæ–¹æ¡ˆ)
    â†“
11-fingerprint (å®Œæ•´æŒ‡çº¹)
    â†“
02-anti-detection (TLSæŒ‡çº¹)
    â†“
24-credential-pool (è´¦å·æ± )
    â†“
07-scheduling (é™æµæ§åˆ¶)
    â†“
04-request (è¯·æ±‚)
    â†“
17-feedback-loop (æ•ˆæœéªŒè¯)
    â†“
05-parsing (è§£æ)
    â†“
06-storage (å­˜å‚¨)
```

**ä»£ç ç¤ºä¾‹:**
```python
# Step 1: ä¾¦æŸ¥
analysis = brain.smart_investigate(url)

# Step 2: åˆ¤æ–­
if analysis.anti_scrape_level == "extreme":
    # Step 3: æ£€æŸ¥é¢„è®¾
    if analysis.matched_preset:
        preset = brain.get_preset(url)
        # ä½¿ç”¨é¢„è®¾é…ç½®

    # Step 4: å¦‚æœæ˜¯need_reverse
    if analysis.recommended_approach == "need_reverse":
        print("éœ€è¦æ·±åº¦é€†å‘ï¼Œå»ºè®®:")
        for step in analysis.next_steps:
            print(f"  - {step}")

        # ä½¿ç”¨RPCæ–¹æ¡ˆæˆ–çœŸå®æµè§ˆå™¨
        # (å‚è€ƒ09-js-reverse.mdçš„RPCç¤ºä¾‹)
```

---

## ğŸŒ³ å†³ç­–æ ‘

### åçˆ¬ç­‰çº§å†³ç­–æ ‘

```
ç”¨æˆ·ä»»åŠ¡
    â†“
è°ƒç”¨: brain.smart_investigate(url)
    â†“
è·å¾—: analysis.anti_scrape_level
    â†“
    â”œâ”€ LOW â”€â”€â”€â”€â”€â”€â†’ æ¨¡å¼1 (ç®€å•æµç¨‹)
    â”‚              Skills: 01 â†’ 04 â†’ 05 â†’ 06
    â”‚
    â”œâ”€ MEDIUM â”€â”€â”€â†’ æ¨¡å¼2 (ä¸­ç­‰æµç¨‹)
    â”‚              Skills: 01 â†’ 02 â†’ 04 â†’ 05 â†’ 06
    â”‚
    â”œâ”€ HIGH â”€â”€â”€â”€â”€â†’ æ¨¡å¼3 (å¤æ‚æµç¨‹)
    â”‚              Skills: 01 â†’ 16 â†’ (03+09) â†’ 02 â†’ 04 â†’ 05 â†’ 06
    â”‚
    â””â”€ EXTREME â”€â”€â†’ æ¨¡å¼4 (æé™æµç¨‹)
                   Skills: 01 â†’ 16 â†’ 09 â†’ 03 â†’ 11 â†’ 02 â†’ 24 â†’ 07 â†’ 04 â†’ 17 â†’ 05 â†’ 06
```

### é”™è¯¯å¤„ç†å†³ç­–æ ‘

```
æ‰§è¡Œå¤±è´¥
    â†“
è§¦å‘: 19-fault-decision-tree
    â†“
    â”œâ”€ ç½‘ç»œå±‚é”™è¯¯ (TIMEOUT/DNS/SSL)
    â”‚      â†“
    â”‚  è‡ªåŠ¨é‡è¯• 3æ¬¡
    â”‚      â†“
    â”‚  ä»å¤±è´¥ â†’ åˆ‡æ¢ä»£ç† â†’ é‡è¯•
    â”‚      â†“
    â”‚  ä»å¤±è´¥ â†’ æŠ¥å‘Šç”¨æˆ·
    â”‚
    â”œâ”€ HTTPå±‚é”™è¯¯ (403/404/429/5xx)
    â”‚      â†“
    â”‚  403 â†’ è¯Šæ–­TLSæŒ‡çº¹/Cookie/IP
    â”‚      â†“
    â”‚  åº”ç”¨ä¿®å¤ (02-anti-detection)
    â”‚      â†“
    â”‚  é‡è¯• â†’ æˆåŠŸ/å¤±è´¥
    â”‚
    â”œâ”€ åçˆ¬å±‚é”™è¯¯ (CAPTCHA/IP_BANNED/SIGNATURE_INVALID)
    â”‚      â†“
    â”‚  CAPTCHA â†’ 10-captcha
    â”‚  IP_BANNED â†’ åˆ‡æ¢ä»£ç† + é™ä½é¢‘ç‡
    â”‚  SIGNATURE_INVALID â†’ 03-signature + 09-js-reverse
    â”‚
    â””â”€ æ•°æ®å±‚é”™è¯¯ (SELECTOR_FAILED/EMPTY_DATA/SCHEMA_MISMATCH)
           â†“
       æ›´æ–°é€‰æ‹©å™¨ / æ ‡è®°partial / æŠ¥å‘Š
```

---

## ğŸ’¡ å®æˆ˜æ¡ˆä¾‹

### æ¡ˆä¾‹1: ç®€å•ä»»åŠ¡ï¼ˆè±†ç“£ç”µå½±ï¼‰

**ç”¨æˆ·è¾“å…¥:**
```
"çˆ¬å–è±†ç“£ç”µå½±Top250çš„æ ‡é¢˜ã€è¯„åˆ†ã€å¯¼æ¼”"
```

**AI Agentå†³ç­–æµç¨‹:**

```python
# 1. ä»»åŠ¡ç†è§£
task_type = "EXPLICIT"  # æœ‰URLã€æœ‰ç›®æ ‡
url = "https://movie.douban.com/top250"
target_fields = ["title", "rating", "director"]

# 2. ä¾¦æŸ¥
analysis = brain.smart_investigate(url)
# ç»“æœ: anti_level = "LOW", recommended_approach = "browser_scrape"

# 3. é€‰æ‹©Skills
skills_chain = [
    "01-reconnaissance",  # å·²å®Œæˆ
    "04-request",         # ç›´æ¥è¯·æ±‚HTML
    "05-parsing",         # è§£æDOM
    "06-storage"          # å­˜å‚¨
]

# 4. æ‰§è¡Œ
result = brain.scrape_with_selector(
    url=url,
    item_selector=".item",
    fields=[
        {"name": "title", "selector": ".title", "attr": "text"},
        {"name": "rating", "selector": ".rating_num", "attr": "text"},
        {"name": "director", "selector": ".bd p", "attr": "text"}
    ],
    max_pages=10  # Top250éœ€è¦ç¿»é¡µ
)

# 5. å¯¼å‡º
brain.export_data(result.data, "douban_top250", format="csv")
```

---

### æ¡ˆä¾‹2: å¤æ‚ä»»åŠ¡ï¼ˆBç«™UPä¸»è§†é¢‘ï¼‰

**ç”¨æˆ·è¾“å…¥:**
```
"è·å–Bç«™UPä¸» uid=123456 çš„æ‰€æœ‰è§†é¢‘æ•°æ®"
```

**AI Agentå†³ç­–æµç¨‹:**

```python
# 1. ä»»åŠ¡ç†è§£
task_type = "EXPLICIT"
url = "https://space.bilibili.com/123456"
target_data = "è§†é¢‘åˆ—è¡¨"

# 2. ä¾¦æŸ¥
analysis = brain.smart_investigate(url)
# ç»“æœ: anti_level = "MEDIUM", æ£€æµ‹åˆ°WBIç­¾å

# 3. é€‰æ‹©Skills
skills_chain = [
    "01-reconnaissance",  # å·²å®Œæˆï¼Œå‘ç°API
    "03-signature",       # éœ€è¦WBIç­¾å
    "02-anti-detection",  # åæ£€æµ‹
    "07-scheduling",      # åˆ†é¡µè°ƒåº¦
    "04-request",         # APIè¯·æ±‚
    "05-parsing",         # JSONè§£æ
    "06-storage"          # å­˜å‚¨
]

# 4. æˆ˜æœ¯å†³ç­–
# Bç«™WBIç­¾åç›¸å¯¹ç®€å•ï¼Œå¯ä»¥ç›´æ¥å¤ç°
# (å‚è€ƒ03-signature.mdçš„Bç«™ç¤ºä¾‹)

# 5. æ‰§è¡Œ
# (è¿™é‡Œæ˜¯ä¼ªä»£ç ç¤ºä¾‹)
wbi_key = get_wbi_key()  # ä»é¡µé¢æå–
signed_params = sign_wbi(params, wbi_key)

results = []
for page in range(1, max_pages+1):
    result = brain.call_api(
        url=f"https://api.bilibili.com/x/space/wbi/arc/search",
        params=signed_params
    )
    results.extend(result.body["data"]["list"]["vlist"])

brain.export_data(results, "bilibili_videos")
```

---

### æ¡ˆä¾‹3: æ•…éšœæ¢å¤ï¼ˆäº¬ä¸œ403ï¼‰

**ç”¨æˆ·è¾“å…¥:**
```
"çˆ¬å–äº¬ä¸œå•†å“ï¼Œä½†é‡åˆ°403é”™è¯¯"
```

**AI Agentå†³ç­–æµç¨‹:**

```python
# 1. ä»»åŠ¡ç±»å‹
task_type = "TROUBLESHOOT"
error_code = "HTTP_403"

# 2. è§¦å‘æ•…éšœå†³ç­–æ ‘
fault_result = diagnose_fault(error_code, context={
    "url": "https://item.jd.com/...",
    "headers": {...},
    "response": "403 Forbidden"
})

# 3. è¯Šæ–­ç»“æœ
# fault_result.root_cause = "TLS_FINGERPRINT"
# fault_result.recovery_actions = [
#     "ä½¿ç”¨curl_cffiåº“",
#     "æ·»åŠ å®Œæ•´æµè§ˆå™¨æŒ‡çº¹",
#     "å¯ç”¨ä»£ç†"
# ]

# 4. è‡ªåŠ¨åº”ç”¨ä¿®å¤
config = AgentConfig(
    use_curl_cffi=True,      # TLSæŒ‡çº¹ä¼ªè£…
    stealth_mode=True,        # åæ£€æµ‹
    proxy_enabled=True        # å¯ç”¨ä»£ç†
)
brain = Brain(config)

# 5. é‡è¯•
result = brain.call_api(url)

# 6. éªŒè¯
if result.success:
    brain.report_cookie_result(success=True)
    # è®°å½•åˆ°17-feedback-loop
else:
    # å‡çº§åˆ°äººå·¥å¤„ç†
    escalate_to_user(fault_result)
```

---

## ğŸ“Š Skillsè°ƒç”¨é¢‘ç‡å‚è€ƒ

åŸºäºä»»åŠ¡ç±»å‹çš„Skillsè°ƒç”¨é¢‘ç‡:

| Skill | è°ƒç”¨é¢‘ç‡ | å¿…é¡»è°ƒç”¨? | è¯´æ˜ |
|-------|---------|----------|------|
| 01-reconnaissance | 100% | âœ… æ˜¯ | æ¯ä¸ªä»»åŠ¡éƒ½è¦å…ˆä¾¦æŸ¥ |
| 18-brain-controller | 100% | âœ… æ˜¯ | ä½ å°±æ˜¯è¿™ä¸ªæ¨¡å— |
| 04-request | 95% | âœ… æ˜¯ | å‡ ä¹æ‰€æœ‰ä»»åŠ¡éƒ½è¦è¯·æ±‚ |
| 05-parsing | 90% | âš ï¸ çœ‹æƒ…å†µ | APIè¿”å›JSONå¯è·³è¿‡ |
| 06-storage | 85% | âŒ å¦ | ç”¨æˆ·è¦æ±‚æ‰å­˜å‚¨ |
| 02-anti-detection | 40% | âŒ å¦ | MEDIUM+æ‰éœ€è¦ |
| 03-signature | 30% | âŒ å¦ | æœ‰ç­¾åæ‰éœ€è¦ |
| 07-scheduling | 25% | âŒ å¦ | æ‰¹é‡ä»»åŠ¡æ‰éœ€è¦ |
| 19-fault-decision-tree | 20% | âŒ å¦ | å‡ºé”™æ—¶è‡ªåŠ¨è§¦å‘ |
| 09-js-reverse | 15% | âŒ å¦ | å¤æ‚ç­¾åæ‰éœ€è¦ |
| 16-tactics | 15% | âŒ å¦ | HIGH+æ‰éœ€è¦ |
| 10-captcha | 10% | âŒ å¦ | é‡åˆ°éªŒè¯ç  |
| å…¶ä»– | <5% | âŒ å¦ | ç‰¹æ®Šåœºæ™¯ |

---

## âœ… éªŒè¯æ¸…å•

åœ¨æ‰§è¡Œæ¯ä¸ªä»»åŠ¡å‰ï¼Œæ£€æŸ¥ä»¥ä¸‹äº‹é¡¹:

### ä»»åŠ¡ç†è§£é˜¶æ®µ
- [ ] æ˜¯å¦æå–äº†URL?
- [ ] æ˜¯å¦æ˜ç¡®äº†ç›®æ ‡æ•°æ®?
- [ ] æ˜¯å¦è¯†åˆ«äº†ä»»åŠ¡ç±»å‹?
- [ ] ä¿¡æ¯æ˜¯å¦å®Œæ•´?ï¼ˆä¸å®Œæ•´åˆ™è¯¢é—®ç”¨æˆ·ï¼‰

### æ¨¡å—é€‰æ‹©é˜¶æ®µ
- [ ] æ˜¯å¦è°ƒç”¨äº†01-reconnaissance?
- [ ] æ˜¯å¦æ ¹æ®anti_levelé€‰æ‹©äº†æ­£ç¡®çš„æ¨¡å¼?
- [ ] æ˜¯å¦æ£€æŸ¥äº†ä¾èµ–å…³ç³»?
- [ ] æ˜¯å¦æœ‰é¢„è®¾é…ç½®å¯ç”¨?

### æ‰§è¡Œé˜¶æ®µ
- [ ] æ˜¯å¦æŒ‰é¡ºåºè°ƒç”¨Skills?
- [ ] æ˜¯å¦å¤„ç†äº†ä¸­é—´ç»“æœ?
- [ ] é‡åˆ°é”™è¯¯æ˜¯å¦è§¦å‘äº†19-fault-decision-tree?
- [ ] æ˜¯å¦è®°å½•äº†æ‰§è¡Œæ—¥å¿—?

### ç»“æœäº¤ä»˜é˜¶æ®µ
- [ ] æ•°æ®æ˜¯å¦ç¬¦åˆé¢„æœŸæ ¼å¼?
- [ ] æ˜¯å¦éœ€è¦å­˜å‚¨?ï¼ˆ06-storageï¼‰
- [ ] æ˜¯å¦éœ€è¦åé¦ˆå­¦ä¹ ?ï¼ˆ17-feedback-loopï¼‰
- [ ] æ˜¯å¦å‘ŠçŸ¥ç”¨æˆ·å®ŒæˆçŠ¶æ€?

---

## ğŸš€ å¿«é€Ÿå‚è€ƒå¡ç‰‡

### ä½ æœ€å¸¸ç”¨çš„ä»£ç æ¨¡å¼

```python
# ========== æ ‡å‡†æµç¨‹æ¨¡æ¿ ==========
from unified_agent import Brain

brain = Brain()

# 1ï¸âƒ£ ä¾¦æŸ¥ï¼ˆå¿…é¡»ï¼‰
analysis = brain.smart_investigate(url)

# 2ï¸âƒ£ å†³ç­–ï¼ˆæ ¹æ®anti_levelï¼‰
if analysis.anti_scrape_level in ["low", "medium"]:
    # ç®€å•æ¨¡å¼
    result = brain.call_api(analysis.main_data_api["url"])

elif analysis.anti_scrape_level == "high":
    # å¤æ‚æ¨¡å¼ï¼šå¯èƒ½éœ€è¦ç­¾å
    # (å‚è€ƒ03-signature.md)
    pass

elif analysis.anti_scrape_level == "extreme":
    # æé™æ¨¡å¼ï¼šæ£€æŸ¥é¢„è®¾æˆ–éœ€è¦é€†å‘
    if analysis.matched_preset:
        preset = brain.get_preset(url)
    else:
        print("éœ€è¦æ·±åº¦é€†å‘")
        print(analysis.next_steps)

# 3ï¸âƒ£ å­˜å‚¨ï¼ˆå¯é€‰ï¼‰
if result.success:
    brain.export_data(result.body, "output")
```

---

## ğŸ”— ç›¸å…³æ–‡æ¡£

- **[SKILLS.md](SKILLS.md)** - Skillsæ€»è§ˆå’Œå·¥ä½œæµç¨‹
- **[SKILL-MATRIX.md](SKILL-MATRIX.md)** - Skillsä¾èµ–çŸ©é˜µ
- **[USAGE_GUIDE.md](USAGE_GUIDE.md)** - äººç±»ç”¨æˆ·ä½¿ç”¨æŒ‡å—
- **[18-brain-controller.md](../skills/18-brain-controller.md)** - ä½ çš„æ ¸å¿ƒé€»è¾‘
- **[19-fault-decision-tree.md](../skills/19-fault-decision-tree.md)** - é”™è¯¯å¤„ç†å†³ç­–
- **[20-e2e-cases.md](../skills/20-e2e-cases.md)** - ç«¯åˆ°ç«¯æ¡ˆä¾‹åº“

---

## ğŸ“Œ æ€»ç»“

**ä½œä¸ºAI Agentï¼Œä½ éœ€è¦ï¼š**

1. âœ… **ç†è§£ä»»åŠ¡** - è¯†åˆ«TYPEï¼Œæå–å…³é”®ä¿¡æ¯
2. âœ… **å…ˆä¾¦æŸ¥** - æ°¸è¿œå…ˆè°ƒç”¨`brain.smart_investigate()`
3. âœ… **çœ‹anti_level** - æ ¹æ®åçˆ¬ç­‰çº§é€‰æ‹©æ¨¡å¼
4. âœ… **ä¸²è”Skills** - æŒ‰ä¾èµ–å…³ç³»é¡ºåºè°ƒç”¨
5. âœ… **è‡ªåŠ¨æ¢å¤** - é”™è¯¯æ—¶è§¦å‘19-fault-decision-tree
6. âœ… **åé¦ˆå­¦ä¹ ** - è®°å½•å†³ç­–å’Œç»“æœåˆ°17-feedback-loop

**è®°ä½ï¼šä½ å°±æ˜¯18-brain-controllerï¼Œè¿™äº›Skillséƒ½æ˜¯ä½ çš„å·¥å…·ï¼**

---

**ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°æ—¥æœŸ**: 2026-01-28
**é€‚ç”¨Agent**: Claude Sonnet/Opus, GPT-4, å…¶ä»–æ”¯æŒfunction callingçš„LLM
