---
skill_id: "18-brain-controller"
name: "å†³ç­–æ€»æ§æ¨¡å—"
version: "1.2.0"
status: "stable"                    # draft | beta | stable | deprecated
implementation_status: "partial"    # none | partial | complete
difficulty: 5
category: "evolution"

description: "ä»»åŠ¡ç†è§£ã€æ¨¡å—ç¼–æ’ã€æ‰§è¡Œè°ƒåº¦çš„ä¸­æ¢æ§åˆ¶å™¨"

triggers:
  - pattern: "(çˆ¬å–|æŠ“å–|è·å–|é‡‡é›†|æå–).*(æ•°æ®|ä¿¡æ¯|å†…å®¹)"
  - pattern: ".*ç½‘ç«™.*(èƒ½ä¸èƒ½çˆ¬|åˆ†æ|ä¾¦æŸ¥)"
  - pattern: ".*(403|éªŒè¯ç |ç­¾å|å°ç¦).*"

priority: "highest"

dependencies:
  required:
    - skill: "01-reconnaissance"
      reason: "å¿…é¡»å…ˆä¾¦æŸ¥ç›®æ ‡"
      min_version: "1.1.0"
    - skill: "16-tactics"
      reason: "ç­–ç•¥å†³ç­–"
      min_version: "1.0.0"
  optional:
    - skill: "all"
      reason: "å¯èƒ½è°ƒç”¨ä»»æ„Skill"
      condition: "æ ¹æ®ä»»åŠ¡ç±»å‹åŠ¨æ€é€‰æ‹©"

external_dependencies:
  required:
    - name: "anthropic"
      version: ">=0.8.0"
      type: "python_package"
      install: "pip install anthropic"
  optional: []

inputs:
  - name: "user_request"
    type: "string"
    required: true
    description: "ç”¨æˆ·çš„è‡ªç„¶è¯­è¨€è¯·æ±‚"
  - name: "context"
    type: "dict"
    required: false
    description: "ä¸Šä¸‹æ–‡ä¿¡æ¯(å†å²è®°å½•ç­‰)"

outputs:
  - name: "execution_plan"
    type: "ExecutionPlan"
    description: "æ‰§è¡Œè®¡åˆ’"
  - name: "result"
    type: "TaskResult"
    description: "ä»»åŠ¡æ‰§è¡Œç»“æœ"

slo:
  - metric: "ä»»åŠ¡ç†è§£å‡†ç¡®ç‡"
    target: "â‰¥ 90%"
    scope: "æ˜ç¡®çš„ä»»åŠ¡æè¿°"
    measurement: "æ­£ç¡®è§£æä»»åŠ¡æ•° / æ€»ä»»åŠ¡æ•°"
    degradation:
      - level: 1
        condition: "å‡†ç¡®ç‡ < 90%"
        action: "è¯·æ±‚ç”¨æˆ·æ¾„æ¸…ä»»åŠ¡ç»†èŠ‚"
      - level: 2
        condition: "å‡†ç¡®ç‡ < 70%"
        action: "æä¾›å¤šä¸ªç†è§£é€‰é¡¹è®©ç”¨æˆ·é€‰æ‹©"
  - metric: "æ¨¡å—é€‰æ‹©æ­£ç¡®ç‡"
    target: "â‰¥ 95%"
    scope: "å·²çŸ¥ç½‘ç«™ç±»å‹"
    measurement: "æ­£ç¡®æ¨¡å—ç»„åˆæ•° / æ€»ä»»åŠ¡æ•°"
    degradation:
      - level: 1
        condition: "æ­£ç¡®ç‡ < 95%"
        action: "ä½¿ç”¨ä¿å®ˆçš„é»˜è®¤æµç¨‹"
  - metric: "ä»»åŠ¡å®Œæˆç‡"
    target: "â‰¥ 85%"
    scope: "æŠ€æœ¯å¯è¡Œçš„ä»»åŠ¡"
    measurement: "æˆåŠŸå®Œæˆä»»åŠ¡æ•° / å°è¯•ä»»åŠ¡æ€»æ•°"
    degradation:
      - level: 1
        condition: "å®Œæˆç‡ < 85%"
        action: "å¢åŠ é‡è¯•æ¬¡æ•°,æ”¾å®½æˆåŠŸæ ‡å‡†"
      - level: 2
        condition: "å®Œæˆç‡ < 60%"
        action: "ä¸ŠæŠ¥ç”¨æˆ·,è¯·æ±‚äººå·¥å¹²é¢„"
  - metric: "å“åº”æ—¶é—´"
    target: "< 30s"
    scope: "ç®€å•ä»»åŠ¡(å•é¡µé‡‡é›†)"
    degradation:
      - level: 1
        condition: "æ—¶é—´ > 30s"
        action: "å¹¶å‘æ‰§è¡Œç‹¬ç«‹æ­¥éª¤"

risks:
  - risk: "AIç†è§£åå·®"
    impact: "ä»»åŠ¡è§£æé”™è¯¯,å¯¼è‡´é”™è¯¯çš„æ‰§è¡Œè®¡åˆ’"
    mitigation: "å…³é”®å†³ç­–ç‚¹è¯·æ±‚ç”¨æˆ·ç¡®è®¤"
  - risk: "æ¨¡å—å¤±è´¥çº§è”"
    impact: "ä¸€ä¸ªæ¨¡å—å¤±è´¥å¯¼è‡´æ•´ä¸ªä»»åŠ¡å¤±è´¥"
    mitigation: "æ¯æ­¥éƒ½æœ‰é™çº§ç­–ç•¥,è®°å½•æ–­ç‚¹"
  - risk: "èµ„æºè€—å°½"
    impact: "å¤æ‚ä»»åŠ¡æ¶ˆè€—è¿‡å¤šèµ„æº"
    mitigation: "é¢„ä¼°èµ„æº,è¶…è¿‡é˜ˆå€¼æ—¶è­¦å‘Šç”¨æˆ·"

limitations:
  - "ä¸èƒ½ç†è§£æåº¦æ¨¡ç³Šçš„ä»»åŠ¡æè¿°"
  - "ä¸èƒ½è‡ªåŠ¨å¤„ç†éœ€è¦äººå·¥åˆ¤æ–­çš„åœºæ™¯"
  - "ä¸èƒ½è·¨ä¼šè¯è®°å¿†æ‰€æœ‰å†å²å†³ç­–"

tags:
  - "orchestration"
  - "decision-making"
  - "task-planning"
  - "workflow"
---

# 18 - å†³ç­–æ€»æ§æ¨¡å— (Brain Controller)

## æ¨¡å—ç›®æ ‡

| ç›®æ ‡ | SLO | é€‚ç”¨èŒƒå›´ | é™çº§ç­–ç•¥ |
|------|-----|----------|----------|
| ä»»åŠ¡è§£æ | å‡†ç¡®ç‡ â‰¥ 90% | æ˜ç¡®çš„ä»»åŠ¡æè¿° | è¯·æ±‚ç”¨æˆ·è¡¥å……ä¿¡æ¯ |
| æ¨¡å—ç¼–æ’ | æ­£ç¡®ç‡ â‰¥ 95% | å·²çŸ¥ç½‘ç«™ç±»å‹ | ä½¿ç”¨é»˜è®¤æµç¨‹ |
| æµç¨‹æ‰§è¡Œ | å®Œæˆç‡ â‰¥ 85% | æŠ€æœ¯å¯è¡Œä»»åŠ¡ | è®°å½•æ–­ç‚¹ï¼ŒæŠ¥å‘Šè¿›åº¦ |
| å¼‚å¸¸å¤„ç† | æ¢å¤ç‡ â‰¥ 80% | å¯è‡ªåŠ¨æ¢å¤é”™è¯¯ | å‡çº§è‡³ç”¨æˆ·å†³ç­– |
| ç»“æœäº¤ä»˜ | å“åº” < 30s | ç®€å•ä»»åŠ¡ | è¿”å›éƒ¨åˆ†æ•°æ®+é”™è¯¯æŠ¥å‘Š |

---

## ä»£ç å®ç°çŠ¶æ€

> **å½“å‰çŠ¶æ€**: âš ï¸ éƒ¨åˆ†å®ç°

| åŠŸèƒ½æ¨¡å— | å®ç°çŠ¶æ€ | ä»£ç ä½ç½® | è¯´æ˜ |
|---------|---------|---------|------|
| ä»»åŠ¡ç†è§£å¼•æ“ | âœ… å®Œæ•´å®ç° | `unified_agent/api/brain.py` | ä½¿ç”¨Claude APIè§£æç”¨æˆ·æ„å›¾ |
| æ¨¡å—é€‰æ‹©å™¨ | âš ï¸ åŸºç¡€å®ç° | `unified_agent/api/orchestrator.py` | æœ‰åŸºæœ¬å†³ç­–æ ‘,éœ€å®Œå–„ |
| æ‰§è¡Œè°ƒåº¦å™¨ | âš ï¸ éƒ¨åˆ†å®ç° | `unified_agent/api/orchestrator.py` | é¡ºåºæ‰§è¡Œ,æ— å¹¶å‘ä¼˜åŒ– |
| çŠ¶æ€è¿½è¸ªå™¨ | âŒ æœªå®ç° | `N/A` | ç¼ºå°‘çŠ¶æ€æŒä¹…åŒ– |
| å¼‚å¸¸æ¢å¤å™¨ | âš ï¸ åŸºç¡€å®ç° | `unified_agent/api/orchestrator.py` | æœ‰é‡è¯•æœºåˆ¶,æ— æ™ºèƒ½æ¢å¤ |
| ç»“æœéªŒè¯å™¨ | âŒ æœªå®ç° | `N/A` | ç¼ºå°‘æ•°æ®è´¨é‡éªŒè¯ |

**å·²å®ç°çš„æ ¸å¿ƒæ¥å£**:
```python
# unified_agent/api/brain.py
class Brain:
    def investigate(url: str) -> SiteReport  # âœ…
    def smart_investigate(url: str) -> SiteAnalysis  # âœ…
    def extract_data(url: str, fields: list) -> dict  # âš ï¸ åŸºç¡€ç‰ˆ

# unified_agent/api/orchestrator.py
class Orchestrator:
    def plan(user_request: str) -> ExecutionPlan  # âš ï¸ åŸºç¡€ç‰ˆ
    def execute(plan: ExecutionPlan) -> TaskResult  # âš ï¸ åŸºç¡€ç‰ˆ
```

---

## æ¥å£å®šä¹‰

### æ ¸å¿ƒæ¥å£

#### plan() - ç”Ÿæˆæ‰§è¡Œè®¡åˆ’

```python
def plan(
    user_request: str,
    context: dict = None,
    auto_confirm: bool = False,
) -> ExecutionPlan
```

**è¾“å…¥å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| user_request | string | æ˜¯ | - | ç”¨æˆ·è‡ªç„¶è¯­è¨€è¯·æ±‚ |
| context | dict | å¦ | {} | ä¸Šä¸‹æ–‡(å†å²/åå¥½) |
| auto_confirm | bool | å¦ | False | æ˜¯å¦è‡ªåŠ¨ç¡®è®¤è®¡åˆ’ |

**è¾“å‡ºç»“æ„**:
```python
@dataclass
class ExecutionPlan:
    task_id: str                    # ä»»åŠ¡ID
    task_type: str                  # explicit/fuzzy/troubleshoot/query
    target_url: str | None          # ç›®æ ‡URL
    target_fields: list[str]        # ç›®æ ‡å­—æ®µ
    steps: list[Step]               # æ‰§è¡Œæ­¥éª¤
    estimated_time: int             # é¢„ä¼°æ—¶é—´(ç§’)
    estimated_cost: float           # é¢„ä¼°æˆæœ¬(APIè°ƒç”¨æ¬¡æ•°)
    risks: list[str]                # é£é™©æç¤º
    requires_confirmation: bool     # æ˜¯å¦éœ€è¦ç¡®è®¤
```

#### execute() - æ‰§è¡Œè®¡åˆ’

```python
def execute(
    plan: ExecutionPlan,
    on_progress: Callable = None,
    max_retries: int = 3,
) -> TaskResult
```

**è¾“å…¥å‚æ•°**:
| å‚æ•° | ç±»å‹ | å¿…é¡» | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| plan | ExecutionPlan | æ˜¯ | - | æ‰§è¡Œè®¡åˆ’ |
| on_progress | Callable | å¦ | None | è¿›åº¦å›è°ƒå‡½æ•° |
| max_retries | int | å¦ | 3 | æœ€å¤§é‡è¯•æ¬¡æ•° |

**è¾“å‡ºç»“æ„**:
```python
@dataclass
class TaskResult:
    status: str                     # success/partial/failed
    data: list[dict] | dict         # æå–çš„æ•°æ®
    metadata: dict                  # å…ƒæ•°æ®
    execution_log: list[dict]       # æ‰§è¡Œæ—¥å¿—
    errors: list[str]               # é”™è¯¯åˆ—è¡¨
    warnings: list[str]             # è­¦å‘Šåˆ—è¡¨
    duration: float                 # æ‰§è¡Œæ—¶é•¿(ç§’)
```

### é”™è¯¯ç 

| é”™è¯¯ç  | è¯´æ˜ | å¤„ç†å»ºè®® |
|--------|------|----------|
| E_BRAIN_001 | ä»»åŠ¡ç†è§£å¤±è´¥ | è¯·ç”¨æˆ·é‡æ–°æè¿°ä»»åŠ¡,æä¾›æ›´å¤šç»†èŠ‚ |
| E_BRAIN_002 | ç¼ºå°‘å¿…è¦ä¿¡æ¯ | è‡ªåŠ¨æé—®è¡¥å……(URL/å­—æ®µ/å‡­æ®) |
| E_BRAIN_003 | æ¨¡å—é€‰æ‹©å¤±è´¥ | ä½¿ç”¨ä¿å®ˆçš„é»˜è®¤æµç¨‹ |
| E_BRAIN_004 | æ‰§è¡Œè¶…æ—¶ | æ£€æŸ¥æ˜¯å¦æ­»å¾ªç¯,å¢åŠ timeout |
| E_BRAIN_005 | æ‰€æœ‰ç­–ç•¥å¤±è´¥ | ä¸ŠæŠ¥ç”¨æˆ·,æ ‡è®°ä¸ºimpossible |
| E_BRAIN_006 | èµ„æºä¸è¶³ | è­¦å‘Šç”¨æˆ·æˆæœ¬,è¯·æ±‚ç¡®è®¤ |
| E_BRAIN_007 | çŠ¶æ€ä¸ä¸€è‡´ | æ¸…ç†çŠ¶æ€,é‡æ–°å¼€å§‹ |

---

## Skill äº¤äº’

### ä¸Šæ¸¸ (è°è°ƒç”¨æˆ‘)

| Skill | è°ƒç”¨åœºæ™¯ | ä¼ å…¥æ•°æ® |
|-------|----------|----------|
| User/CLI | æ‰€æœ‰ä»»åŠ¡èµ·ç‚¹ | user_request(è‡ªç„¶è¯­è¨€) |
| MCP Client | é€šè¿‡MCPåè®®è°ƒç”¨ | tool_call(ç»“æ„åŒ–è¯·æ±‚) |

### ä¸‹æ¸¸ (æˆ‘è°ƒç”¨è°)

æœ¬æ¨¡å—ä½œä¸ºä¸­æ¢,å¯èƒ½è°ƒç”¨ä»»ä½•Skill:

| Skillç¾¤ç»„ | è°ƒç”¨åœºæ™¯ | ä¼ å‡ºæ•°æ® |
|----------|----------|----------|
| 01-reconnaissance | æ¯ä¸ªæ–°ä»»åŠ¡å¼€å§‹ | url, wait_seconds |
| 16-tactics | ä¾¦æŸ¥åé€‰æ‹©ç­–ç•¥ | site_analysis |
| 03+09 | éœ€è¦ç­¾åé€†å‘ | js_code, params |
| 02+11 | é«˜åçˆ¬ç½‘ç«™ | stealth_config |
| 04-request | å‘é€æ‰€æœ‰è¯·æ±‚ | url, params, headers |
| 05-parsing | æå–æ•°æ® | html, selectors |
| 06-storage | ä¿å­˜ç»“æœ | data, format |
| 08-diagnosis | ä»»ä½•é”™è¯¯å‘ç”Ÿ | error_context |
| 19-fault-tree | æ•…éšœæ¢å¤ | error_type |
| 17-feedback-loop | ä»»åŠ¡å®Œæˆå | execution_log |

### å†³ç­–æ—¶åºå›¾

```
ç”¨æˆ·è¯·æ±‚
   â”‚
   â–¼
[18-brain] æ¥æ”¶ä»»åŠ¡
   â”‚
   â”œâ”€â†’ ç†è§£ä»»åŠ¡ (Claude API)
   â”‚     â””â”€â†’ ç”Ÿæˆ TaskSpec
   â”‚
   â”œâ”€â†’ è¯„ä¼°å¯è¡Œæ€§
   â”‚     â”œâ”€ æ˜ç¡®ä»»åŠ¡ â†’ ç»§ç»­
   â”‚     â”œâ”€ æ¨¡ç³Šä»»åŠ¡ â†’ è¯·æ±‚æ¾„æ¸…
   â”‚     â””â”€ ä¸å¯è¡Œ â†’ æ‹’ç»+è¯´æ˜ç†ç”±
   â”‚
   â”œâ”€â†’ é€‰æ‹©æ¨¡å—åºåˆ—
   â”‚     â””â”€â†’ è°ƒç”¨ 01-reconnaissance
   â”‚           â””â”€â†’ è°ƒç”¨ 16-tactics
   â”‚                 â””â”€â†’ ç”Ÿæˆ ExecutionPlan
   â”‚
   â”œâ”€â†’ æ‰§è¡Œè®¡åˆ’
   â”‚     â”œâ”€â†’ é¡ºåºæ‰§è¡Œå„æ­¥éª¤
   â”‚     â”œâ”€â†’ ç›‘æ§çŠ¶æ€
   â”‚     â”œâ”€â†’ é”™è¯¯å¤„ç† (08+19)
   â”‚     â””â”€â†’ é™çº§ç­–ç•¥
   â”‚
   â”œâ”€â†’ éªŒè¯ç»“æœ
   â”‚     â”œâ”€ å®Œæ•´ â†’ äº¤ä»˜
   â”‚     â”œâ”€ éƒ¨åˆ† â†’ æ ‡è®°+äº¤ä»˜
   â”‚     â””â”€ å¤±è´¥ â†’ ä¸ŠæŠ¥åŸå› 
   â”‚
   â””â”€â†’ å­¦ä¹ åé¦ˆ (17-feedback-loop)
         â””â”€â†’ æ›´æ–°çŸ¥è¯†åº“
```

---

## ä¸€ã€ä»»åŠ¡æ¥æ”¶ä¸ç†è§£

### ä»»åŠ¡ç±»å‹è¯†åˆ«

```
ç”¨æˆ·è¾“å…¥ â†’ ä»»åŠ¡ç±»å‹è¯†åˆ« â†’ æ‰§è¡Œè·¯å¾„é€‰æ‹©

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä»»åŠ¡ç±»å‹çŸ©é˜µ                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  TYPE_EXPLICIT (æ˜ç¡®ä»»åŠ¡):                                                   â”‚
â”‚  â”œâ”€â”€ IF: urlå­˜åœ¨ AND target_fieldså®šä¹‰ â†’ ACTION: direct_execute             â”‚
â”‚  â”œâ”€â”€ pattern: "çˆ¬å–{site}{data}"  â†’ extract(site, data)                     â”‚
â”‚  â””â”€â”€ pattern: "è·å–{url}çš„{field}" â†’ scrape(url, selector=field)            â”‚
â”‚                                                                             â”‚
â”‚  TYPE_FUZZY (æ¨¡ç³Šä»»åŠ¡):                                                      â”‚
â”‚  â”œâ”€â”€ IF: urlå­˜åœ¨ AND target_fieldsç¼ºå¤± â†’ ACTION: ask_clarification          â”‚
â”‚  â”œâ”€â”€ pattern: "åˆ†æ.*ç½‘ç«™"         â†’ CALL: 01-reconnaissance                â”‚
â”‚  â””â”€â”€ pattern: "ç›‘æ§.*å˜åŒ–"         â†’ ASK: frequency, scope                  â”‚
â”‚                                                                             â”‚
â”‚  TYPE_TROUBLESHOOT (æ•…éšœè¯Šæ–­):                                               â”‚
â”‚  â”œâ”€â”€ IF: error_codeå­˜åœ¨ â†’ ACTION: CALL 19-fault-decision-tree               â”‚
â”‚  â”œâ”€â”€ pattern: "403|forbidden"     â†’ CALL: diagnose_403()                    â”‚
â”‚  â”œâ”€â”€ pattern: "éªŒè¯ç |captcha"    â†’ CALL: 10-captcha                        â”‚
â”‚  â””â”€â”€ pattern: "ç­¾å|signature"    â†’ CALL: 03-signature + 09-js-reverse      â”‚
â”‚                                                                             â”‚
â”‚  TYPE_QUERY (ä¿¡æ¯æŸ¥è¯¢):                                                      â”‚
â”‚  â”œâ”€â”€ IF: æ— actionåŠ¨è¯ â†’ ACTION: query_knowledge                             â”‚
â”‚  â”œâ”€â”€ pattern: "{site}åçˆ¬"        â†’ QUERY: knowledge.sites[site]            â”‚
â”‚  â””â”€â”€ pattern: "ä»€ä¹ˆç®—æ³•|æ€ä¹ˆ.*"   â†’ QUERY: knowledge.techniques             â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»»åŠ¡è§£ææµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä»»åŠ¡è§£ææµç¨‹                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   ç”¨æˆ·è¾“å…¥                                                                   â”‚
â”‚      â”‚                                                                      â”‚
â”‚      â–¼                                                                      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚   â”‚ 1. æå–å…³é”®ä¿¡æ¯  â”‚                                                       â”‚
â”‚   â”‚   - ç›®æ ‡URL/ç½‘ç«™ â”‚                                                       â”‚
â”‚   â”‚   - æƒ³è¦çš„æ•°æ®   â”‚                                                       â”‚
â”‚   â”‚   - æ•°é‡/èŒƒå›´    â”‚                                                       â”‚
â”‚   â”‚   - æ—¶é—´è¦æ±‚     â”‚                                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     ä¿¡æ¯ä¸è¶³                                          â”‚
â”‚   â”‚ 2. ä¿¡æ¯å®Œæ•´æ€§æ£€æŸ¥â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ å‘ç”¨æˆ·æé—®è¡¥å……                         â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚            â”‚ ä¿¡æ¯å®Œæ•´                                                        â”‚
â”‚            â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚   â”‚ 3. ç”Ÿæˆä»»åŠ¡è®¡åˆ’  â”‚                                                       â”‚
â”‚   â”‚   - é€‰æ‹©æ¨¡å—    â”‚                                                       â”‚
â”‚   â”‚   - ç¡®å®šé¡ºåº    â”‚                                                       â”‚
â”‚   â”‚   - é¢„ä¼°èµ„æº    â”‚                                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚            â”‚                                                                â”‚
â”‚            â–¼                                                                â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                       â”‚
â”‚   â”‚ 4. ç¡®è®¤åæ‰§è¡Œ    â”‚                                                       â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                       â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€æ ‡å‡†æ‰§è¡Œæµç¨‹

### å®Œæ•´ä»»åŠ¡æµç¨‹å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ ‡å‡†æ‰§è¡Œæµç¨‹                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                               â”‚
â”‚  â”‚ æ¥æ”¶ä»»åŠ¡ â”‚                                                               â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚       â”‚                                                                     â”‚
â”‚       â–¼                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ä¸ç†Ÿæ‚‰    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚ äº†è§£ç›®æ ‡? â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ 00-å¿«é€Ÿå¼€å§‹: èµ„æºè¯„ä¼°                     â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜              â”‚ 01-ä¾¦æŸ¥: æ•è·è¯·æ±‚ã€åˆ†æç‰¹å¾               â”‚    â”‚
â”‚       â”‚ ç†Ÿæ‚‰               â”‚ 16-æˆ˜æœ¯: å‘ç°å…¥å£ã€é€‰æ‹©ç­–ç•¥               â”‚    â”‚
â”‚       â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚       â–¼                                          â”‚                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚                         â”‚
â”‚  â”‚ æœ‰ç­¾å?  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜                                                               â”‚
â”‚       â”‚                                                                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”                                                                â”‚
â”‚  â”‚         â”‚                                                                â”‚
â”‚  â–¼ æœ‰      â–¼ æ—                                                              â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                                                â”‚
â”‚ â”‚03-ç­¾å â”‚ â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚ â”‚09-é€†å‘ â”‚ â”‚   â”‚                    è¯·æ±‚é˜¶æ®µ                             â”‚  â”‚
â”‚ â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚   â”‚                                                        â”‚  â”‚
â”‚     â”‚      â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚  â”‚
â”‚     â””â”€â”€â”¬â”€â”€â”€â”˜   â”‚  â”‚02-åæ£€æµ‹ â”‚ â†’  â”‚04-è¯·æ±‚   â”‚ â†’  â”‚ å“åº”åˆ¤æ–­ â”‚        â”‚  â”‚
â”‚        â”‚       â”‚  â”‚11-æŒ‡çº¹   â”‚    â”‚07-è°ƒåº¦   â”‚    â”‚          â”‚        â”‚  â”‚
â”‚        â”‚       â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜        â”‚  â”‚
â”‚        â–¼       â”‚                                       â”‚               â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                       â”‚               â”‚  â”‚
â”‚  â”‚ å‡†å¤‡è¯·æ±‚  â”‚â”€â”˜                                       â”‚               â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                         â”‚               â”‚  â”‚
â”‚                                                        â”‚               â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚                                                                         â”‚
â”‚  â”‚   æˆåŠŸ (2xx)              å¤±è´¥ (4xx/5xx)           éªŒè¯ç /å°ç¦         â”‚
â”‚  â”‚      â”‚                         â”‚                        â”‚              â”‚
â”‚  â”‚      â–¼                         â–¼                        â–¼              â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚  â”‚05-è§£æ  â”‚            â”‚08-è¯Šæ–­    â”‚           â”‚10-éªŒè¯ç   â”‚         â”‚
â”‚  â”‚  â”‚æå–æ•°æ® â”‚            â”‚åˆ†æåŸå›    â”‚           â”‚16-æˆ˜æœ¯    â”‚         â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜            â”‚ç»™å‡ºæ–¹æ¡ˆ   â”‚           â”‚åˆ‡æ¢ç­–ç•¥   â”‚         â”‚
â”‚  â”‚       â”‚                 â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â”‚
â”‚  â”‚       â”‚                       â”‚                       â”‚               â”‚
â”‚  â”‚       â”‚                       â–¼                       â”‚               â”‚
â”‚  â”‚       â”‚                  å¯ä¿®å¤? â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚  â”‚       â”‚                    â”‚ æ˜¯        â”‚ å¦                           â”‚
â”‚  â”‚       â”‚                    â–¼           â–¼                              â”‚
â”‚  â”‚       â”‚                 é‡è¯•        ä¸ŠæŠ¥ç”¨æˆ·                           â”‚
â”‚  â”‚       â”‚                    â”‚                                          â”‚
â”‚  â”‚       â–¼                    â”‚                                          â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚                                          â”‚
â”‚  â”‚  â”‚06-å­˜å‚¨  â”‚ â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (æˆåŠŸå)                                 â”‚
â”‚  â”‚  â”‚ä¿å­˜æ•°æ® â”‚                                                          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                          â”‚
â”‚  â”‚       â”‚                                                               â”‚
â”‚  â”‚       â–¼                                                               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚  â”‚17-åé¦ˆ  â”‚                                                          â”‚
â”‚  â”‚  â”‚è®°å½•ç»éªŒ â”‚                                                          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜                                                          â”‚
â”‚  â”‚       â”‚                                                               â”‚
â”‚  â”‚       â–¼                                                               â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                          â”‚
â”‚  â”‚  â”‚ äº¤ä»˜ç»“æœ â”‚                                                          â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                                          â”‚
â”‚  â”‚                                                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€æ¨¡å—é€‰æ‹©å†³ç­–è¡¨

### æ ¹æ®ä»»åŠ¡ç‰¹å¾é€‰æ‹©æ¨¡å—

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           æ¨¡å—é€‰æ‹©å†³ç­–è¡¨                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ¡ä»¶(Condition)          â”‚  åŠ¨ä½œ(Action)                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                           â”‚                                                 â”‚
â”‚ site.known == false       â”‚  CALL: [00, 01, 16] # è¯„ä¼°â†’ä¾¦æŸ¥â†’å…¥å£å‘ç°       â”‚
â”‚                           â”‚                                                 â”‚
â”‚ request.has_signature     â”‚  CALL: [03, 09]     # ç­¾ååˆ†æâ†’JSé€†å‘          â”‚
â”‚                           â”‚                                                 â”‚
â”‚ site.anti_crawl >= HIGH   â”‚  CALL: [02, 11]     # åæ£€æµ‹â†’æŒ‡çº¹              â”‚
â”‚                           â”‚                                                 â”‚
â”‚ site.requires_login       â”‚  CALL: [24, login_flow] # å‡­æ®æ± â†’ç™»å½•          â”‚
â”‚                           â”‚                                                 â”‚
â”‚ response.has_captcha      â”‚  CALL: [10]         # éªŒè¯ç å¤„ç†                â”‚
â”‚                           â”‚                                                 â”‚
â”‚ task.item_count > 1000    â”‚  CALL: [07, 13]     # è°ƒåº¦â†’åˆ†å¸ƒå¼              â”‚
â”‚                           â”‚                                                 â”‚
â”‚ target.type == "APP"      â”‚  CALL: [12]         # ç§»åŠ¨ç«¯æ¨¡å—                â”‚
â”‚                           â”‚                                                 â”‚
â”‚ error.occurred == true    â”‚  CALL: [08, 19, 17] # è¯Šæ–­â†’æ•…éšœæ ‘â†’åé¦ˆ        â”‚
â”‚                           â”‚                                                 â”‚
â”‚ task.type == "monitor"    â”‚  CALL: [14, 07]     # ç›‘æ§â†’è°ƒåº¦                â”‚
â”‚              â”‚                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç½‘ç«™éš¾åº¦ vs æ¨¡å—ç»„åˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           éš¾åº¦-æ¨¡å—æ˜ å°„                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ğŸŸ¢ ç®€å• (å½“å½“ã€è‹å®æ˜“è´­)                                                    â”‚
â”‚     â””â”€â”€ 01ä¾¦æŸ¥ â†’ 04è¯·æ±‚ â†’ 05è§£æ â†’ 06å­˜å‚¨                                   â”‚
â”‚                                                                             â”‚
â”‚  ğŸŸ¡ ä¸­ç­‰ (çŸ¥ä¹ã€å“”å“©å“”å“©)                                                    â”‚
â”‚     â””â”€â”€ 01ä¾¦æŸ¥ â†’ 03ç­¾å â†’ 02åæ£€æµ‹ â†’ 04è¯·æ±‚ â†’ 05è§£æ â†’ 06å­˜å‚¨              â”‚
â”‚                                                                             â”‚
â”‚  ğŸ”´ å›°éš¾ (å°çº¢ä¹¦ã€å¾®åš)                                                      â”‚
â”‚     â””â”€â”€ 01ä¾¦æŸ¥ â†’ 16æˆ˜æœ¯ â†’ 03ç­¾å â†’ 09é€†å‘                                   â”‚
â”‚         â†’ 02åæ£€æµ‹ â†’ 11æŒ‡çº¹ â†’ 04è¯·æ±‚ â†’ 10éªŒè¯ç (å¦‚æœ‰)                       â”‚
â”‚         â†’ 05è§£æ â†’ 06å­˜å‚¨ â†’ 17åé¦ˆ                                          â”‚
â”‚                                                                             â”‚
â”‚  âš« æéš¾ (äº¬ä¸œã€æ·˜å®ã€æŠ–éŸ³)                                                  â”‚
â”‚     â””â”€â”€ 01ä¾¦æŸ¥ â†’ 16æˆ˜æœ¯(å…¥å£å‘ç°) â†’ 03ç­¾å â†’ 09æ·±åº¦é€†å‘                     â”‚
â”‚         â†’ 02åæ£€æµ‹ â†’ 11æŒ‡çº¹ â†’ 04è¯·æ±‚(ä»£ç†å¿…é¡»)                              â”‚
â”‚         â†’ 10éªŒè¯ç  â†’ 07è°ƒåº¦(é™æµ) â†’ 05è§£æ â†’ 06å­˜å‚¨                         â”‚
â”‚         â†’ 08è¯Šæ–­(æŒç»­) â†’ 17åé¦ˆ(ç»éªŒç§¯ç´¯)                                   â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## å››ã€å¼‚å¸¸å¤„ç†å†³ç­–æ ‘

### è¯·æ±‚å¤±è´¥å¤„ç†

```
è¯·æ±‚è¿”å›å¼‚å¸¸
    â”‚
    â”œâ”€â”€ 4xx å®¢æˆ·ç«¯é”™è¯¯
    â”‚   â”œâ”€â”€ 400 Bad Request
    â”‚   â”‚   â””â”€â”€ æ£€æŸ¥: å‚æ•°æ ¼å¼ã€ç­¾åã€ç¼–ç 
    â”‚   â”‚       â””â”€â”€ åŠ¨ä½œ: 03ç­¾åæ£€æŸ¥ â†’ ä¿®æ­£å‚æ•° â†’ é‡è¯•
    â”‚   â”‚
    â”‚   â”œâ”€â”€ 401 Unauthorized
    â”‚   â”‚   â””â”€â”€ æ£€æŸ¥: Token/Cookie æ˜¯å¦è¿‡æœŸ
    â”‚   â”‚       â””â”€â”€ åŠ¨ä½œ: é‡æ–°ç™»å½• â†’ åˆ·æ–°ä¼šè¯ â†’ é‡è¯•
    â”‚   â”‚
    â”‚   â”œâ”€â”€ 403 Forbidden
    â”‚   â”‚   â”œâ”€â”€ IP å°ç¦ â†’ 04åˆ‡æ¢ä»£ç† â†’ é‡è¯•
    â”‚   â”‚   â”œâ”€â”€ ç­¾åé”™è¯¯ â†’ 03é‡æ–°ç­¾å â†’ é‡è¯•
    â”‚   â”‚   â”œâ”€â”€ æŒ‡çº¹è¢«æ£€æµ‹ â†’ 11æ¢æŒ‡çº¹ â†’ é‡è¯•
    â”‚   â”‚   â””â”€â”€ æƒé™ä¸è¶³ â†’ æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•
    â”‚   â”‚
    â”‚   â”œâ”€â”€ 404 Not Found
    â”‚   â”‚   â””â”€â”€ æ£€æŸ¥: URLæ˜¯å¦æ­£ç¡®ã€æ¥å£æ˜¯å¦ä¸‹çº¿
    â”‚   â”‚       â””â”€â”€ åŠ¨ä½œ: 01é‡æ–°ä¾¦æŸ¥ â†’ å¯»æ‰¾æ–°æ¥å£
    â”‚   â”‚
    â”‚   â””â”€â”€ 429 Too Many Requests
    â”‚       â””â”€â”€ åŠ¨ä½œ: 07é™ä½é€Ÿç‡ â†’ ç­‰å¾… â†’ é‡è¯•
    â”‚
    â”œâ”€â”€ 5xx æœåŠ¡ç«¯é”™è¯¯
    â”‚   â”œâ”€â”€ 500/502/503
    â”‚   â”‚   â””â”€â”€ åŠ¨ä½œ: ç­‰å¾…30s â†’ é‡è¯•3æ¬¡ â†’ æ”¾å¼ƒå¹¶è®°å½•
    â”‚   â””â”€â”€ 504 Gateway Timeout
    â”‚       â””â”€â”€ åŠ¨ä½œ: å¢åŠ è¶…æ—¶æ—¶é—´ â†’ é‡è¯•
    â”‚
    â””â”€â”€ ç½‘ç»œé”™è¯¯
        â”œâ”€â”€ ConnectionError
        â”‚   â””â”€â”€ åŠ¨ä½œ: æ£€æŸ¥ä»£ç† â†’ åˆ‡æ¢ä»£ç† â†’ é‡è¯•
        â”œâ”€â”€ Timeout
        â”‚   â””â”€â”€ åŠ¨ä½œ: å¢åŠ è¶…æ—¶ â†’ é‡è¯•
        â””â”€â”€ SSL Error
            â””â”€â”€ åŠ¨ä½œ: æ£€æŸ¥TLSé…ç½® â†’ 02è°ƒæ•´æŒ‡çº¹
```

### æ•°æ®å¼‚å¸¸å¤„ç†

```
æ•°æ®æå–å¼‚å¸¸
    â”‚
    â”œâ”€â”€ é€‰æ‹©å™¨åŒ¹é…å¤±è´¥
    â”‚   â”œâ”€â”€ é¡µé¢ç»“æ„å˜åŒ– â†’ 01é‡æ–°ä¾¦æŸ¥ â†’ æ›´æ–°é€‰æ‹©å™¨
    â”‚   â”œâ”€â”€ åŠ¨æ€åŠ è½½æœªå®Œæˆ â†’ å¢åŠ ç­‰å¾…æ—¶é—´ â†’ é‡è¯•
    â”‚   â””â”€â”€ åçˆ¬è¿”å›ç©ºé¡µé¢ â†’ 16åˆ‡æ¢ç­–ç•¥
    â”‚
    â”œâ”€â”€ æ•°æ®æ ¼å¼å¼‚å¸¸
    â”‚   â”œâ”€â”€ JSON è§£æå¤±è´¥ â†’ æ£€æŸ¥æ˜¯å¦è¿”å› HTML (å¯èƒ½æ˜¯éªŒè¯ç )
    â”‚   â”œâ”€â”€ å­—æ®µç¼ºå¤± â†’ æ£€æŸ¥æ˜¯å¦éœ€è¦ç™»å½•æ‰èƒ½çœ‹åˆ°å®Œæ•´æ•°æ®
    â”‚   â””â”€â”€ ç¼–ç é”™è¯¯ â†’ å°è¯•ä¸åŒç¼–ç 
    â”‚
    â””â”€â”€ æ•°æ®å†…å®¹å¼‚å¸¸
        â”œâ”€â”€ æ•°æ®æ˜æ˜¾é”™è¯¯ â†’ 17éªŒè¯æ•°æ® â†’ å¯èƒ½æ˜¯æŠ•æ¯’
        â”œâ”€â”€ æ•°æ®ä¸å®Œæ•´ â†’ æ£€æŸ¥åˆ†é¡µæ˜¯å¦é—æ¼
        â””â”€â”€ æ•°æ®é‡å¤ â†’ æ£€æŸ¥å»é‡é€»è¾‘
```

---

## äº”ã€ç”¨æˆ·äº¤äº’å†³ç­–

### ä»€ä¹ˆæ—¶å€™é—®ç”¨æˆ·

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           éœ€è¦é—®ç”¨æˆ·çš„æƒ…å†µ                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚  ASK_REQUIRED (å¿…é¡»è¯¢é—®):                                                    â”‚
â”‚     - IF: url == null              â†’ ASK: "ç›®æ ‡URL"                         â”‚
â”‚     - IF: target_fields == null    â†’ ASK: "éœ€è¦å“ªäº›å­—æ®µ"                    â”‚
â”‚     - IF: requires_login AND credential == null â†’ ASK: "ç™»å½•å‡­æ®"           â”‚
â”‚     - IF: cost > budget_threshold  â†’ ASK: "æ˜¯å¦æ¥å—æˆæœ¬: {cost}"            â”‚
â”‚     - IF: len(valid_strategies) > 1 â†’ ASK: "é€‰æ‹©æ–¹æ¡ˆ: {options}"            â”‚
â”‚                                                                             â”‚
â”‚  ASK_RECOMMENDED (å»ºè®®è¯¢é—®):                                                 â”‚
â”‚     - IF: estimated_items > 10000  â†’ ASK: "ç¡®è®¤èŒƒå›´: {scope}"               â”‚
â”‚     - IF: len(entry_points) > 1    â†’ ASK: "å…¥å£ä¼˜å…ˆçº§: {entries}"           â”‚
â”‚     - IF: risk_level >= MEDIUM     â†’ ASK: "ç¡®è®¤é£é™©æ“ä½œ: {action}"          â”‚
â”‚                                                                             â”‚
â”‚  NO_ASK (è‡ªä¸»å†³ç­–):                                                          â”‚
â”‚     - IF: is_implementation_detail â†’ DECIDE: auto                           â”‚
â”‚     - IF: auto_recoverable == true â†’ DECIDE: auto_retry                     â”‚
â”‚     - IF: len(valid_options) == 1  â†’ DECIDE: options[0]                     â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä»€ä¹ˆæ—¶å€™ç»§ç»­å°è¯• vs åœä¸‹æ¥

```
CONTINUE_RETRY:
  - IF: len(untried_strategies) > 0     â†’ retry_with_next_strategy()
  - IF: error.type IN [TIMEOUT, TEMP_BAN, NETWORK] â†’ wait_and_retry(backoff)
  - IF: user.instruction == "persist"   â†’ escalate_effort()

STOP_AND_REPORT:
  - IF: len(untried_strategies) == 0    â†’ report_exhausted(tried_strategies)
  - IF: required_resource == null       â†’ request_resource(type=[credential|proxy])
  - IF: decision_required == true       â†’ escalate_to_user(decision_type)
  - IF: target.exists == false          â†’ report_impossible(reason)
```

---

## å…­ã€å¿«é€Ÿè·¯å¾„

### å¸¸è§ä»»åŠ¡çš„å¿«é€Ÿæ‰§è¡Œè·¯å¾„

```python
# è·¯å¾„1: ç®€å•é¡µé¢æŠ“å–
async def quick_scrape(url: str):
    """
    ç”¨äº: é™æ€é¡µé¢ã€æ— åçˆ¬ã€å…¬å¼€æ•°æ®
    """
    # ç›´æ¥è¯·æ±‚ + è§£æï¼Œè·³è¿‡ä¾¦æŸ¥
    response = await call_api(url)
    data = extract_data(response)
    return data

# è·¯å¾„2: API æ•°æ®è·å–
async def quick_api(api_url: str, params: dict):
    """
    ç”¨äº: å·²çŸ¥APIã€å·²æœ‰ç­¾åæ–¹æ¡ˆ
    """
    # ç­¾å + è¯·æ±‚
    signed_params = sign_request(params)
    response = await call_api(api_url, params=signed_params)
    return response.json()

# è·¯å¾„3: å®Œæ•´æµç¨‹
async def full_scrape(target: str):
    """
    ç”¨äº: æ–°ç½‘ç«™ã€å¤æ‚ä»»åŠ¡
    """
    # 1. ä¾¦æŸ¥
    analysis = await smart_investigate(target)

    # 2. é€‰æ‹©ç­–ç•¥
    strategy = select_strategy(analysis)

    # 3. å‡†å¤‡ (ç­¾å/æŒ‡çº¹/ä»£ç†)
    context = await prepare_context(strategy)

    # 4. æ‰§è¡Œ
    result = await execute_with_retry(context)

    # 5. å­˜å‚¨
    await save_result(result)

    # 6. å­¦ä¹ 
    await record_experience(target, strategy, result)

    return result
```

---

## ä¸ƒã€çŠ¶æ€è¿½è¸ª

### ä»»åŠ¡çŠ¶æ€æœº

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           ä»»åŠ¡çŠ¶æ€æµè½¬                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                             â”‚
â”‚   PENDING â†’ ANALYZING â†’ PREPARING â†’ EXECUTING â†’ EXTRACTING â†’ COMPLETED     â”‚
â”‚      â”‚          â”‚           â”‚           â”‚            â”‚            â”‚         â”‚
â”‚      â”‚          â”‚           â”‚           â”‚            â”‚            â”‚         â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                              â”‚                                              â”‚
â”‚                              â–¼                                              â”‚
â”‚                           FAILED â”€â”€â†’ DIAGNOSING â”€â”€â†’ RETRYING               â”‚
â”‚                              â”‚                          â”‚                   â”‚
â”‚                              â”‚                          â”‚                   â”‚
â”‚                              â–¼                          â”‚                   â”‚
â”‚                         ABANDONED â†â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ (è¶…è¿‡é‡è¯•æ¬¡æ•°)    â”‚
â”‚                                                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ¯ä¸ªçŠ¶æ€çš„èŒè´£

| çŠ¶æ€ | èŒè´£ | ä¸‹ä¸€æ­¥ |
|------|------|--------|
| PENDING | ä»»åŠ¡å·²æ¥æ”¶ï¼Œç­‰å¾…å¤„ç† | â†’ ANALYZING |
| ANALYZING | ç†è§£ä»»åŠ¡ï¼Œé€‰æ‹©æ¨¡å— | â†’ PREPARING |
| PREPARING | å‡†å¤‡èµ„æº(ç­¾å/ä»£ç†/æŒ‡çº¹) | â†’ EXECUTING |
| EXECUTING | å‘é€è¯·æ±‚ | â†’ EXTRACTING æˆ– FAILED |
| EXTRACTING | æå–æ•°æ® | â†’ COMPLETED æˆ– FAILED |
| COMPLETED | ä»»åŠ¡å®Œæˆï¼Œå­˜å‚¨æ•°æ® | ç»“æŸ |
| FAILED | æ‰§è¡Œå¤±è´¥ | â†’ DIAGNOSING |
| DIAGNOSING | åˆ†æå¤±è´¥åŸå›  | â†’ RETRYING æˆ– ABANDONED |
| RETRYING | åº”ç”¨ä¿®å¤æ–¹æ¡ˆé‡è¯• | â†’ EXECUTING |
| ABANDONED | æ— æ³•å®Œæˆï¼Œä¸ŠæŠ¥ç”¨æˆ· | ç»“æŸ |

---

## å…«ã€è¯Šæ–­æ—¥å¿—

```
# ä»»åŠ¡æ¥æ”¶
[BRAIN] æ”¶åˆ°ä»»åŠ¡: "çˆ¬å–äº¬ä¸œå•†å“ä»·æ ¼"
[BRAIN] ä»»åŠ¡ç±»å‹: æ˜ç¡®ç›®æ ‡
[BRAIN] æå–ä¿¡æ¯: ç½‘ç«™=jd.com, æ•°æ®=å•†å“ä»·æ ¼

# æ¨¡å—é€‰æ‹©
[BRAIN] æŸ¥è¯¢çŸ¥è¯†åº“: jd.com
[BRAIN] éš¾åº¦è¯„ä¼°: extreme
[BRAIN] é€‰æ‹©æ¨¡å—: 01+16+03+09+02+11+04+07+05+06+17

# æµç¨‹æ‰§è¡Œ
[BRAIN] çŠ¶æ€: PENDING â†’ ANALYZING
[BRAIN] è°ƒç”¨æ¨¡å—: 01-ä¾¦æŸ¥
[BRAIN] çŠ¶æ€: ANALYZING â†’ PREPARING
[BRAIN] è°ƒç”¨æ¨¡å—: 03-ç­¾å, 02-åæ£€æµ‹
[BRAIN] çŠ¶æ€: PREPARING â†’ EXECUTING
[BRAIN] è°ƒç”¨æ¨¡å—: 04-è¯·æ±‚

# å¼‚å¸¸å¤„ç†
[BRAIN] è¯·æ±‚å¤±è´¥: 403 Forbidden
[BRAIN] çŠ¶æ€: EXECUTING â†’ FAILED â†’ DIAGNOSING
[BRAIN] è°ƒç”¨æ¨¡å—: 08-è¯Šæ–­
[BRAIN] è¯Šæ–­ç»“æœ: ç­¾åè¿‡æœŸ
[BRAIN] ä¿®å¤æ–¹æ¡ˆ: é‡æ–°ç”Ÿæˆç­¾å
[BRAIN] çŠ¶æ€: DIAGNOSING â†’ RETRYING â†’ EXECUTING

# æˆåŠŸå®Œæˆ
[BRAIN] è¯·æ±‚æˆåŠŸ: 200 OK
[BRAIN] çŠ¶æ€: EXECUTING â†’ EXTRACTING
[BRAIN] è°ƒç”¨æ¨¡å—: 05-è§£æ
[BRAIN] æå–æ•°æ®: 100 æ¡å•†å“
[BRAIN] çŠ¶æ€: EXTRACTING â†’ COMPLETED
[BRAIN] è°ƒç”¨æ¨¡å—: 06-å­˜å‚¨, 17-åé¦ˆ

# ç»éªŒè®°å½•
[BRAIN] è®°å½•ç»éªŒ: jd.com, ç­–ç•¥=mobile_api, æˆåŠŸ
```

---

## ç›¸å…³æ¨¡å—

æœ¬æ¨¡å—æ˜¯æ‰€æœ‰å…¶ä»–æ¨¡å—çš„è°ƒåº¦ä¸­å¿ƒï¼š

- **è¾“å…¥**: ç”¨æˆ·ä»»åŠ¡
- **è°ƒåº¦**: 00-17 æ‰€æœ‰æ¨¡å—
- **è¾“å‡º**: æ•°æ®ç»“æœ + æ‰§è¡ŒæŠ¥å‘Š

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ 18-æ€»æ§   â”‚
                    â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                          â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                 â”‚                 â”‚
        â–¼                 â–¼                 â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ ä¾¦æŸ¥å±‚  â”‚       â”‚ æ‰§è¡Œå±‚  â”‚       â”‚ æ”¯æ’‘å±‚  â”‚
   â”‚ 00,01   â”‚       â”‚ 02-07   â”‚       â”‚ 08-17   â”‚
   â”‚ 16      â”‚       â”‚         â”‚       â”‚         â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```


## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: ç®€å•ä»»åŠ¡ - çˆ¬å–è±†ç“£ç”µå½±Top250

**åœºæ™¯**: æ˜ç¡®URL + ç›®æ ‡æ•°æ®,æ— å¤æ‚åçˆ¬

```python
from unified_agent import Brain

brain = Brain()

# ç”¨æˆ·è¯·æ±‚
user_request = "çˆ¬å–è±†ç“£ç”µå½±Top250çš„ç”µå½±åç§°ã€è¯„åˆ†ã€å¯¼æ¼”"

# 1. ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
plan = brain.plan(user_request)

print(f"ä»»åŠ¡ç±»å‹: {plan.task_type}")
print(f"ç›®æ ‡URL: {plan.target_url}")
print(f"ç›®æ ‡å­—æ®µ: {plan.target_fields}")
print(f"æ‰§è¡Œæ­¥éª¤: {len(plan.steps)}ä¸ª")
print(f"é¢„ä¼°æ—¶é—´: {plan.estimated_time}ç§’")

# 2. æ‰§è¡Œè®¡åˆ’(å¸¦è¿›åº¦å›è°ƒ)
def on_progress(step_name, progress, total):
    print(f"[{progress}/{total}] {step_name}")

result = brain.execute(plan, on_progress=on_progress)

# 3. æŸ¥çœ‹ç»“æœ
if result.status == "success":
    print(f"æˆåŠŸæå– {len(result.data)} æ¡æ•°æ®")
    print("ç¤ºä¾‹æ•°æ®:", result.data[0])
else:
    print(f"å¤±è´¥: {result.errors}")
```

**é¢„æœŸè¾“å‡º**:
```
ä»»åŠ¡ç±»å‹: explicit
ç›®æ ‡URL: https://movie.douban.com/top250
ç›®æ ‡å­—æ®µ: ['ç”µå½±åç§°', 'è¯„åˆ†', 'å¯¼æ¼”']
æ‰§è¡Œæ­¥éª¤: 5ä¸ª
é¢„ä¼°æ—¶é—´: 15ç§’

[1/5] 01-reconnaissance: ä¾¦æŸ¥ç›®æ ‡ç½‘ç«™
[2/5] 16-tactics: é€‰æ‹©æ‰§è¡Œç­–ç•¥
[3/5] 04-request: å‘é€HTTPè¯·æ±‚
[4/5] 05-parsing: è§£æHTMLæå–æ•°æ®
[5/5] 06-storage: ä¿å­˜æ•°æ®

æˆåŠŸæå– 250 æ¡æ•°æ®
ç¤ºä¾‹æ•°æ®: {
  "ç”µå½±åç§°": "è‚–ç”³å…‹çš„æ•‘èµ",
  "è¯„åˆ†": "9.7",
  "å¯¼æ¼”": "å¼—å…°å…‹Â·å¾·æ‹‰é‚¦ç‰¹"
}
```

---

### ç¤ºä¾‹2: å¤æ‚ä»»åŠ¡ - çˆ¬å–Bç«™UPä¸»è§†é¢‘æ•°æ®

**åœºæ™¯**: éœ€è¦ä¾¦æŸ¥API + WBIç­¾å + åˆ†é¡µå¤„ç†

```python
from unified_agent import Brain

brain = Brain()

# ç”¨æˆ·è¯·æ±‚
user_request = """
çˆ¬å–Bç«™UPä¸»(mid=123456)çš„æ‰€æœ‰è§†é¢‘æ•°æ®,
åŒ…æ‹¬: æ ‡é¢˜ã€æ’­æ”¾é‡ã€ç‚¹èµæ•°ã€å‘å¸ƒæ—¶é—´
"""

# 1. ç”Ÿæˆæ‰§è¡Œè®¡åˆ’
plan = brain.plan(user_request, auto_confirm=False)

print("æ‰§è¡Œè®¡åˆ’:")
for i, step in enumerate(plan.steps, 1):
    print(f"{i}. {step.skill_name}: {step.description}")

print(f"\né£é™©æç¤º: {plan.risks}")

# 2. ç”¨æˆ·ç¡®è®¤
if input("æ˜¯å¦æ‰§è¡Œ? (y/n): ") == "y":
    result = brain.execute(plan)

    # 3. æŸ¥çœ‹æ‰§è¡Œæ—¥å¿—
    print("\næ‰§è¡Œæ—¥å¿—:")
    for log in result.execution_log:
        print(f"[{log['timestamp']}] {log['skill']}: {log['action']}")

    # 4. ç»“æœ
    if result.status == "success":
        print(f"\næˆåŠŸ: æå– {len(result.data)} ä¸ªè§†é¢‘")
```

---

### ç¤ºä¾‹3: æ•…éšœæ¢å¤ - é‡åˆ°403åçš„å†³ç­–æµç¨‹

**åœºæ™¯**: è¯·æ±‚è¢«æ‹’ç»,è‡ªåŠ¨è¯Šæ–­å¹¶æ¢å¤

```python
from unified_agent import Brain

brain = Brain()

# é…ç½®é‡è¯•ç­–ç•¥
brain.config.update({
    "max_retries": 5,
    "auto_recovery": True,
    "escalate_on_failure": True,
})

# ç”¨æˆ·è¯·æ±‚
user_request = "çˆ¬å–äº¬ä¸œå•†å“è¯¦æƒ…(sku=100012345678)"

# æ‰§è¡Œä»»åŠ¡
result = brain.execute(brain.plan(user_request))

# æŸ¥çœ‹æ•…éšœæ¢å¤è®°å½•
if result.status in ["success", "partial"]:
    print("ä»»åŠ¡å®Œæˆ!")

    # æŸ¥çœ‹æ˜¯å¦ç»å†è¿‡å¤±è´¥
    failures = [log for log in result.execution_log if log.get("error")]
    if failures:
        print(f"\nç»å†äº† {len(failures)} æ¬¡å¤±è´¥,ä½†è‡ªåŠ¨æ¢å¤:")
        for fail in failures:
            print(f"  - {fail['error']} â†’ {fail['recovery_action']}")
```

---

## é…ç½®é€‰é¡¹

### å…¨å±€é…ç½®

```python
# config.py

BRAIN_CONFIG = {
    # ä»»åŠ¡ç†è§£é…ç½®
    "task_understanding": {
        "llm_model": "claude-sonnet-4.5",
        "temperature": 0.0,
        "max_clarifications": 3,
        "auto_fill_defaults": True,
    },

    # æ¨¡å—é€‰æ‹©é…ç½®
    "module_selection": {
        "strategy": "conservative",
        "skip_reconnaissance": False,
        "prefer_approach": "api",
        "parallel_execution": False,
    },

    # æ‰§è¡Œé…ç½®
    "execution": {
        "max_retries": 3,
        "retry_delay": 1,
        "timeout": 30,
        "total_timeout": 300,
        "auto_recovery": True,
        "escalate_on_failure": True,
    },

    # èµ„æºé™åˆ¶
    "resource_limits": {
        "max_api_calls": 100,
        "max_pages": 1000,
        "max_items": 10000,
        "warn_threshold": 50,
    },

    # æ—¥å¿—é…ç½®
    "logging": {
        "level": "INFO",
        "save_execution_log": True,
        "log_dir": "./logs/brain",
        "keep_days": 7,
    },
}
```

### è¿è¡Œæ—¶é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|--------|------|--------|------|
| max_retries | int | 3 | æœ€å¤§é‡è¯•æ¬¡æ•° |
| auto_confirm | bool | False | æ˜¯å¦è‡ªåŠ¨ç¡®è®¤è®¡åˆ’ |
| parallel_execution | bool | False | æ˜¯å¦å¹¶å‘æ‰§è¡Œ |
| save_execution_log | bool | True | æ˜¯å¦ä¿å­˜æ—¥å¿— |
| timeout | int | 30 | å•æ­¥è¶…æ—¶(ç§’) |
| auto_recovery | bool | True | è‡ªåŠ¨æ•…éšœæ¢å¤ |
| log_level | str | "INFO" | æ—¥å¿—çº§åˆ« |

---

## è¯Šæ–­æ—¥å¿—

### æ ‡å‡†æ—¥å¿—æ ¼å¼

```
[BRAIN] <é˜¶æ®µ> <æ“ä½œ>: <è¯¦æƒ…>
```

### æ­£å¸¸æµç¨‹æ—¥å¿—

```
# ä»»åŠ¡æ¥æ”¶
[BRAIN] RECEIVE æ”¶åˆ°ä»»åŠ¡: "çˆ¬å–äº¬ä¸œå•†å“ä»·æ ¼"
[BRAIN] UNDERSTAND è¯†åˆ«ä»»åŠ¡ç±»å‹: explicit
[BRAIN] UNDERSTAND æå–ä¿¡æ¯: url=jd.com, fields=[ä»·æ ¼]

# æ¨¡å—é€‰æ‹©
[BRAIN] PLAN æ£€æµ‹æ¡ä»¶: has_signature=yes
[BRAIN] PLAN é€‰æ‹©æ¨¡å—: [01, 16, 03, 09, 02, 04, 05, 06]
[BRAIN] PLAN é¢„ä¼°æ—¶é—´: 45ç§’

# æ‰§è¡Œé˜¶æ®µ
[BRAIN] EXECUTE çŠ¶æ€: PENDING â†’ ANALYZING
[BRAIN] EXECUTE æ­¥éª¤ 1/8: 01-reconnaissance
[BRAIN] EXECUTE æ­¥éª¤ 2/8: 16-tactics
[BRAIN] EXECUTE çŠ¶æ€: ANALYZING â†’ EXECUTING
[BRAIN] EXECUTE æ­¥éª¤ 8/8: 06-storage
[BRAIN] EXECUTE çŠ¶æ€: EXTRACTING â†’ COMPLETED

# å®Œæˆ
[BRAIN] COMPLETE ä»»åŠ¡å®Œæˆ
[BRAIN] COMPLETE æ•°æ®é‡: 100 æ¡
[BRAIN] COMPLETE æ€»è€—æ—¶: 43.2s
```

### é”™è¯¯æ—¥å¿—

```
[BRAIN] UNDERSTAND ERROR: æ— æ³•ç†è§£ä»»åŠ¡
[BRAIN] UNDERSTAND ç¼ºå¤±ä¿¡æ¯: url, target_fields
[BRAIN] UNDERSTAND é”™è¯¯ç : E_BRAIN_001

[BRAIN] EXECUTE ERROR: æ‰§è¡Œè¶…æ—¶
[BRAIN] EXECUTE è¶…æ—¶æ—¶é—´: 300s
[BRAIN] EXECUTE å½“å‰æ­¥éª¤: 03-signature
[BRAIN] EXECUTE é”™è¯¯ç : E_BRAIN_004

[BRAIN] EXECUTE ERROR: æ‰€æœ‰ç­–ç•¥å·²å°è¯•å®Œæ¯•
[BRAIN] EXECUTE å°è¯•ç­–ç•¥: ['direct', 'with_signature', 'browser']
[BRAIN] EXECUTE é”™è¯¯ç : E_BRAIN_005
```

### AIè‡ªè¯Šæ–­æ£€æŸ¥ç‚¹

```python
AI_DIAGNOSTIC_CHECKLIST = [
    {
        "checkpoint": "TASK_UNDERSTANDING",
        "checks": [
            "ç”¨æˆ·è¯·æ±‚æ˜¯å¦åŒ…å«æ˜ç¡®URL?",
            "ç”¨æˆ·è¯·æ±‚æ˜¯å¦æ˜ç¡®æ•°æ®å­—æ®µ?",
            "ä»»åŠ¡ç±»å‹æ˜¯å¦æ­£ç¡®è¯†åˆ«?",
        ],
        "auto_fix": [
            "IF urlç¼ºå¤±: ç”Ÿæˆé—®é¢˜è¯·æ±‚URL",
            "IF fieldsç¼ºå¤±: ç”Ÿæˆé—®é¢˜è¯·æ±‚å­—æ®µ",
            "IF ç±»å‹é”™è¯¯: é‡æ–°è°ƒç”¨LLMåˆ†æ",
        ],
    },
    {
        "checkpoint": "MODULE_SELECTION",
        "checks": [
            "é€‰æ‹©çš„æ¨¡å—æ˜¯å¦ç¬¦åˆç½‘ç«™ç‰¹å¾?",
            "æ˜¯å¦å­˜åœ¨å¾ªç¯ä¾èµ–?",
            "æ¨¡å—é¡ºåºæ˜¯å¦æ­£ç¡®?",
        ],
        "auto_fix": [
            "IF æ¨¡å—ä¸åŒ¹é…: é‡æ–°é€‰æ‹©",
            "IF å¾ªç¯ä¾èµ–: æ‰“ç ´å¾ªç¯",
            "IF é¡ºåºé”™è¯¯: é‡æ–°æ’åº",
        ],
    },
    {
        "checkpoint": "EXECUTION_MONITORING",
        "checks": [
            "å½“å‰æ­¥éª¤æ˜¯å¦è¶…æ—¶?",
            "æ˜¯å¦é™·å…¥æ­»å¾ªç¯?",
            "èµ„æºæ¶ˆè€—æ˜¯å¦è¶…é™?",
        ],
        "auto_fix": [
            "IF è¶…æ—¶: å¢åŠ timeout",
            "IF æ­»å¾ªç¯: å¼ºåˆ¶ä¸­æ–­",
            "IF è¶…é™: è­¦å‘Šç”¨æˆ·",
        ],
    },
]
```

---

## FAQ

### Q1: å¦‚ä½•é€‰æ‹©æ‰§è¡Œç­–ç•¥?

A: æ ¹æ®åœºæ™¯é€‰æ‹©:

**Conservative (ä¿å®ˆ)** - é«˜ä»·å€¼ä»»åŠ¡,æœªçŸ¥ç½‘ç«™
**Balanced (å¹³è¡¡)** - é»˜è®¤,ä¸€èˆ¬ä»»åŠ¡
**Aggressive (æ¿€è¿›)** - å¿«é€Ÿæµ‹è¯•,ç†Ÿæ‚‰ç½‘ç«™

```python
brain.config["module_selection"]["strategy"] = "conservative"
```

### Q2: æ¨¡å—ç¼–æ’å¤±è´¥æ€ä¹ˆåŠ?

A: Brainä¼šè‡ªåŠ¨æ£€æµ‹å¾ªç¯ä¾èµ–å¹¶æ‰“ç ´ã€‚æ‰‹åŠ¨æŒ‡å®šç½‘ç«™ç±»å‹:

```python
plan = brain.plan(
    user_request,
    context={"site_hint": {"difficulty": "high"}}
)
```

### Q3: å¦‚ä½•è‡ªå®šä¹‰å†³ç­–è§„åˆ™?

A: åŠ è½½è‡ªå®šä¹‰è§„åˆ™æ–‡ä»¶æˆ–ç¼–ç¨‹å¼è§„åˆ™:

```python
brain.load_rules("custom_rules.yaml")
```

### Q4: å¦‚ä½•ç›‘æ§æ‰§è¡Œè¿›åº¦?

A: ä½¿ç”¨è¿›åº¦å›è°ƒ:

```python
def on_progress(step_name, current, total, details):
    print(f"[{current}/{total}] {step_name}")

result = brain.execute(plan, on_progress=on_progress)
```

### Q5: ä»»åŠ¡å¤±è´¥åå¦‚ä½•æ‰‹åŠ¨æ¢å¤?

A: ä½¿ç”¨æ–­ç‚¹æ¢å¤:

```python
result = brain.resume(
    task_id=result.metadata["task_id"],
    from_step=failed_step,
    context=context,
)
```

---

## å˜æ›´å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´ç±»å‹ | è¯´æ˜ |
|------|------|----------|------|
| 1.2.0 | 2026-01-28 | enhancement | å®Œå–„æ–‡æ¡£:æ·»åŠ ä½¿ç”¨ç¤ºä¾‹/é…ç½®é€‰é¡¹/è¯Šæ–­æ—¥å¿—/AIè‡ªè¯Šæ–­/FAQ |
| 1.1.0 | 2026-01-27 | feature | æ·»åŠ æ•…éšœæ¢å¤æµç¨‹ |
| 1.0.0 | 2026-01-25 | initial | åˆå§‹ç‰ˆæœ¬ |

---

## ç›¸å…³æ¨¡å—

æœ¬æ¨¡å—æ˜¯æ‰€æœ‰å…¶ä»–æ¨¡å—çš„è°ƒåº¦ä¸­å¿ƒ:

- **è¾“å…¥**: ç”¨æˆ·ä»»åŠ¡
- **è°ƒåº¦**: 00-26 æ‰€æœ‰æ¨¡å—
- **è¾“å‡º**: æ•°æ®ç»“æœ + æ‰§è¡ŒæŠ¥å‘Š

**ç‰¹åˆ«è¯´æ˜**: æœ¬æ¨¡å—ä½œä¸ºä¸­æ¢,ä¸è¢«å…¶ä»–æ¨¡å—ç›´æ¥è°ƒç”¨,è€Œæ˜¯ç”±ç”¨æˆ·/CLI/MCPè§¦å‘ã€‚
